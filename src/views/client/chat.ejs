<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title><%- title %></title>
        <link rel="stylesheet" href="/css/chat-new.css" />
        <link rel="stylesheet" href="/css/toast.css" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
            integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        />

        <script
            src="https://kit.fontawesome.com/8bf767fd4b.js"
            crossorigin="anonymous"
        ></script>

        <link rel="icon" href="/images/cupid.png" />

        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <div class="layout">
            <%- include("./infor-user-room.ejs") %>

            <div class="conversation">
                <div id="notification"></div>
                <div class="conversation-information">
                    <div class="name-conversation">
                        <img
                            src="https://res.cloudinary.com/soicondibui/image/upload/v1642665781/sosichat/icon/question_2_p4nifa.png"
                            alt="image"
                        />

                        <h3><%- title %></h3>
                    </div>

                    <div class="conversation-option">
                        <img
                            src="https://res.cloudinary.com/soicondibui/image/upload/v1642672221/sosichat/icon/i_m7xyhw.png"
                            alt="img"
                        />
                    </div>
                </div>

                <div class="box-message">
                    <% for(let i = 0;i< message.length;i++) {%> <% if (user._id
                    == message[i].user_id) { %>

                    <div class="message my-message">
                        <div>
                            <div class="message-user">
                                <img
                                    src="<%- message[i].avatar %>"
                                    alt="avatar"
                                />
                                <p><%- message[i].user_name %></p>
                            </div>

                            <div class="message-content">
                                <div class="content">
                                    <span><%- message[i].content %></span>
                                </div>
                                <div class="time-send">
                                    <span><%- message[i].time %></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <% } else { %>
                    <div class="message">
                        <div>
                            <div class="message-user">
                                <img
                                    src="<%- message[i].avatar %>"
                                    alt="avatar"
                                />
                                <p><%- message[i].user_name %></p>
                            </div>

                            <div class="message-content">
                                <div class="content">
                                    <span><%- message[i].content %></span>
                                </div>
                                <div class="time-send">
                                    <span><%- message[i].time %></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %> <% } %>
                </div>

                <form id="chat-form" class="box-send-message">
                    <!-- <div class="box-send-message"> -->
                    <input
                        class="input-message"
                        id="msg"
                        type="text"
                        placeholder="Enter Message"
                        required
                        autocomplete="off"
                        autofocus
                    />
                    <button
                        class="fa fa-paper-plane"
                        style="border: none; cursor: pointer"
                    ></button>
                    <!-- </div> -->
                </form>
            </div>
        </div>

        <form name="form-redirect" method="GET"></form>

        <script
            src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
            crossorigin="anonymous"
        ></script>

        <script>
            //infor user
            var user_id = '<%- user._id%>';
            var user_name = '<%- user.username %>';

            function redirectRoom(id) {
                window.location.href = id;
            }
        </script>

        <script src="/js/chat-script.js"></script>
        <script src="/js/toast.js"></script>
        <script src="/js/createRoom.js"></script>
    </body>
</html>

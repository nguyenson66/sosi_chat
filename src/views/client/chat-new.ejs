<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="/css/chat-new.css" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
            integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        />

        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <div class="layout">
            <div class="information">
                <div class="control">
                    <div class="avatar-user">
                        <img
                            src="https://res.cloudinary.com/soicondibui/image/upload/v1642665781/sosichat/icon/user_h0cglb.png"
                            alt="avatar"
                        />
                    </div>

                    <h2>Chat</h2>

                    <i class="fa fa-gear"></i>
                </div>

                <div class="list-room">

                    <% for(let i=0;i<list_room.length;i++) { %> 
                        <div class="room-information">
                            <div class="avatar-room">
                                <img src="https://res.cloudinary.com/soicondibui/image/upload/v1642665782/sosichat/icon/people_a9kmc5.png" alt="room" />
                            </div>

                            <div class="content-room">
                                <h6><%- list_room[i].title %></h6>
                                <p>BOT : Chúc các bạn trò chuyện vui vẻ</p>
                            </div>
                        </div>
                    <% } %>
                </div>

                <div class="report-error">
                    <img
                        src="https://res.cloudinary.com/soicondibui/image/upload/v1642669694/sosichat/icon/error_juzubm.png"
                        alt="error"
                    />
                    <h6>Report - Báo lỗi</h6>
                </div>
            </div>

            <div class="conversation">
                <div class="conversation-information">
                    <div class="name-conversation">
                        <img
                            src="https://res.cloudinary.com/soicondibui/image/upload/v1642665781/sosichat/icon/question_2_p4nifa.png"
                            alt="image"
                        />

                        <h2>Người lạ</h2>
                    </div>

                    <div class="conversation-option">
                        <img
                            src="https://res.cloudinary.com/soicondibui/image/upload/v1642672221/sosichat/icon/i_m7xyhw.png"
                            alt="img"
                        />
                    </div>
                </div>

                <div class="box-message">
                    <% for(let i = 0;i< message.length;i++) {%> <% if (user._id
                    == message[i].user_id) { %>

                    <div class="message my-message">
                        <div>
                            <div class="message-user">
                                <img
                                    src="https://res.cloudinary.com/soicondibui/image/upload/v1642665781/sosichat/icon/question_2_p4nifa.png"
                                    alt="avatar"
                                />
                                <p><%- message[i].user_name %></p>
                            </div>

                            <div class="message-content">
                                <p><%- message[i].content %></p>
                            </div>
                        </div>
                    </div>

                    <% } else { %>
                    <div class="message">
                        <div>
                            <div class="message-user">
                                <img
                                    src="https://res.cloudinary.com/soicondibui/image/upload/v1642665781/sosichat/icon/question_2_p4nifa.png"
                                    alt="avatar"
                                />
                                <p><%- message[i].user_name %></p>
                            </div>

                            <div class="message-content">
                                <p><%- message[i].content %></p>
                            </div>
                        </div>
                    </div>
                    <% } %> <% } %>
                </div>

                <form id="chat-form" class="box-send-message">
                    <!-- <div class="box-send-message"> -->
                    <input
                        class="input-message"
                        id="msg"
                        type="text"
                        placeholder="Enter Message"
                        required
                        autocomplete="off"
                        autofocus
                    />
                    <button
                        class="fa fa-paper-plane"
                        style="border: none; cursor: pointer"
                    ></button>
                    <!-- </div> -->
                </form>
            </div>
        </div>

        <form name="form-redirect" method="GET"></form>

        <script
            src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
            crossorigin="anonymous"
        ></script>

        <script>
            //infor user
            var user_id = '<%- user._id%>';
            var user_name = '<%- user.user_name %>';
        </script>

        <script src="/js/chat-script.js"></script>
    </body>
</html>
